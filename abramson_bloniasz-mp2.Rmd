---
title: "Mini Project 2"
author: "Mathena Abramson"
date: "October 23, 2017"
output: html_document
---

```{r, message = FALSE}
library(tidyverse)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

```{r}
glimpse(house_elections)
glimpse(candidates)
glimpse(committees)
glimpse(contributions)
```

```{r}
cand12 <- candidates %>%
  filter(cand_office == "H")
  
cand_contrib <- cand12 %>%
  inner_join(contributions, by = "cand_id") %>%
  select(1:8, -7, 16, 19, 21:23, 27:30, 35)
  
glimpse(cand_contrib)
```

```{r}
new_comm <- select(committees, -15)

comm_cand_contrib <- cand_contrib %>%
  inner_join(new_comm, by = "cmte_id") %>%
  select(1:12, 15:19, 25:30)
arrange(comm_cand_contrib, cand_name)
```

```{r}
house_elections <- house_elections %>%
  rename(cand_id = fec_id)

full_contrib <- comm_cand_contrib %>%
  inner_join(house_elections, by = "cand_id")

glimpse(full_contrib)
```

```{r}
cand_funct <- function(name_arg){
  full_contrib %>%
    filter(cand_name == name_arg) %>%
    group_by(cand_election_yr) %>%
    summarize(N = n(),
    victory = sum(ifelse(ge_winner == "W", n, 0)) %>%
    total_trans = sum(transaction_amt), avg_transaction = mean(transaction_amt)) %>%
arrange(desc(cand_election_yr)) %>%
ggplot(full_contrib, aes(x = cand_name, y = total_trans)) +
  geom_bar(aes(fill = victory))
  }

name_funct(data = full_contrib, name_arg = "ROBY, MARTHA")
```
